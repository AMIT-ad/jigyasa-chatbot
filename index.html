<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tejas - Voice AI Assistant</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #059669;
            --accent: #d97706;
            --dark: #0f172a;
            --light: #f8fafc;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .app-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            min-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 20px;
            text-align: center;
            color: white;
            position: relative;
        }

        .avatar-container {
            width: 80px;
            height: 80px;
            margin: 0 auto 10px;
            border-radius: 50%;
            border: 3px solid white;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .avatar {
            font-size: 2rem;
            color: var(--primary);
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 1rem;
            opacity: 0.9;
        }

        .menu-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dropdown-menu {
            position: absolute;
            top: 70px;
            right: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            padding: 10px;
            z-index: 1000;
            display: none;
            min-width: 200px;
        }

        .dropdown-menu.show {
            display: block;
        }

        .menu-item {
            padding: 12px 15px;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
            border-radius: 8px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .menu-item:hover {
            background: #f1f5f9;
        }

        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-box {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8fafc;
            max-height: 400px;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            animation: fadeInUp 0.3s ease;
        }

        .user-message {
            justify-content: flex-end;
        }

        .message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            flex-shrink: 0;
            font-size: 0.8rem;
        }

        .user-avatar {
            background: var(--primary);
        }

        .bot-avatar {
            background: var(--secondary);
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
            font-size: 0.9rem;
        }

        .user-message .message-content {
            background: linear-gradient(135deg, var(--primary), #3b82f6);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .bot-message .message-content {
            background: white;
            color: var(--dark);
            border: 1px solid #e2e8f0;
            border-bottom-left-radius: 5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .input-area {
            padding: 15px;
            background: white;
            border-top: 1px solid #e2e8f0;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        #userInput {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 25px;
            font-size: 0.9rem;
            outline: none;
        }

        #userInput:focus {
            border-color: var(--primary);
        }

        .input-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1.2rem;
        }

        .voice-btn {
            width: 45px;
            height: 45px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .voice-btn.listening {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            animation: pulse 1.5s infinite;
        }

        .voice-btn:hover {
            transform: scale(1.05);
        }

        .footer {
            text-align: center;
            padding: 15px;
            background: var(--dark);
            color: white;
            font-size: 0.8rem;
        }

        .footer a {
            color: var(--accent);
            text-decoration: none;
            font-weight: 600;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        #listeningStatus {
            text-align: center;
            color: #dc2626;
            margin: 10px 0;
            display: none;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 8px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--secondary);
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-8px); }
        }

        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
        }

        .quick-action-btn {
            padding: 8px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .quick-action-btn:hover {
            border-color: var(--primary);
            background: var(--light);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 15px;
            max-width: 90%;
            max-height: 80%;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
        }

        .modal-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--dark);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #64748b;
        }

        @media (max-width: 768px) {
            .app-container {
                min-height: 95vh;
            }
            
            .message-content {
                max-width: 85%;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <button class="menu-btn" onclick="toggleMenu()">‚ãØ</button>
            <div class="dropdown-menu" id="dropdownMenu">
                <button class="menu-item" onclick="showStories()">
                    <span>üìñ</span> Stories / ‡§ï‡§π‡§æ‡§®‡§ø‡§Ø‡§æ‡§Ç
                </button>
                <button class="menu-item" onclick="showJokes()">
                    <span>üòÇ</span> Jokes / ‡§ö‡•Å‡§ü‡§ï‡•Å‡§≤‡•á
                </button>
                <button class="menu-item" onclick="showMotivation()">
                    <span>üí´</span> Motivation / ‡§™‡•ç‡§∞‡•á‡§∞‡§£‡§æ
                </button>
                <button class="menu-item" onclick="saveChatAsPDF()">
                    <span>üìÑ</span> Save PDF / PDF ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
                </button>
                <button class="menu-item" onclick="toggleVoice()">
                    <span>üîä</span> <span id="voiceStatus">Voice On</span>
                </button>
                <button class="menu-item" onclick="clearChat()">
                    <span>üóëÔ∏è</span> Clear Chat / ‡§ö‡•à‡§ü ‡§∏‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç
                </button>
            </div>
            <div class="avatar-container">
                <div class="avatar">ü§ñ</div>
            </div>
            <h1>Tejas AI</h1>
            <p>Speak ‚Ä¢ Type ‚Ä¢ Listen ‚Ä¢ ‡§¨‡•ã‡§≤‡•á‡§Ç ‚Ä¢ ‡§≤‡§ø‡§ñ‡•á‡§Ç ‚Ä¢ ‡§∏‡•Å‡§®‡•á‡§Ç</p>
        </div>

        <div class="chat-area">
            <div id="listeningStatus">üé§ Listening... / ‡§∏‡•Å‡§® ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Ç...</div>
            <div class="chat-box" id="chat">
                <div class="message bot-message">
                    <div class="message-avatar bot-avatar">ü§ñ</div>
                    <div class="message-content">
                        <strong>Namaste! Welcome! üôè</strong><br><br>
                        You can:<br>
                        ‚Ä¢ <strong>Speak</strong> - Click mic button<br>
                        ‚Ä¢ <strong>Type</strong> - Type in the box<br>
                        ‚Ä¢ <strong>Listen</strong> - I'll speak responses<br><br>
                        Use <strong>‚ãØ menu</strong> for stories, jokes & more!
                    </div>
                </div>
            </div>

            <div class="input-area">
                <div class="input-wrapper">
                    <input type="text" id="userInput" placeholder="Type here or click mic to speak... / ‡§Ø‡§π‡§æ‡§Å ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§Æ‡§æ‡§á‡§ï ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§ï‡•á ‡§¨‡•ã‡§≤‡•á‡§Ç..." onkeydown="if(event.key==='Enter') sendMessage()">
                    <button class="input-icon" onclick="sendMessage()">üì§</button>
                </div>
                <button class="voice-btn" id="voiceButton" onclick="toggleListening()">
                    üé§
                </button>
            </div>
        </div>

        <div class="footer">
            <b>For More GPTs Visit: <a href="https://sites.google.com/view/custom-gpt-store/home" target="_blank">GPT Store</a></b>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="storiesModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Stories / ‡§ï‡§π‡§æ‡§®‡§ø‡§Ø‡§æ‡§Ç</div>
                <button class="close-btn" onclick="closeModal('storiesModal')">√ó</button>
            </div>
            <div class="quick-actions">
                <button class="quick-action-btn" onclick="tellStory('hindi', 0)">‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§Æ‡§æ‡§® ‡§ï‡§ø‡§∏‡§æ‡§®</button>
                <button class="quick-action-btn" onclick="tellStory('hindi', 1)">‡§à‡§Æ‡§æ‡§®‡§¶‡§æ‡§∞ ‡§≤‡§ï‡§°‡§º‡§π‡§æ‡§∞‡§æ</button>
                <button class="quick-action-btn" onclick="tellStory('hindi', 2)">‡§¶‡•ã‡§∏‡•ç‡§§‡•Ä ‡§ï‡•Ä ‡§∂‡§ï‡•ç‡§§‡§ø</button>
                <button class="quick-action-btn" onclick="tellStory('english', 0)">The Wise Farmer</button>
                <button class="quick-action-btn" onclick="tellStory('english', 1)">Honest Woodcutter</button>
                <button class="quick-action-btn" onclick="tellStory('english', 2)">Power of Friendship</button>
            </div>
        </div>
    </div>

    <div class="modal" id="jokesModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Jokes / ‡§ö‡•Å‡§ü‡§ï‡•Å‡§≤‡•á</div>
                <button class="close-btn" onclick="closeModal('jokesModal')">√ó</button>
            </div>
            <div class="quick-actions">
                <button class="quick-action-btn" onclick="tellJoke('hindi', 0)">‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§ö‡•Å‡§ü‡§ï‡•Å‡§≤‡§æ 1</button>
                <button class="quick-action-btn" onclick="tellJoke('hindi', 1)">‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§ö‡•Å‡§ü‡§ï‡•Å‡§≤‡§æ 2</button>
                <button class="quick-action-btn" onclick="tellJoke('hindi', 2)">‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§ö‡•Å‡§ü‡§ï‡•Å‡§≤‡§æ 3</button>
                <button class="quick-action-btn" onclick="tellJoke('english', 0)">English Joke 1</button>
                <button class="quick-action-btn" onclick="tellJoke('english', 1)">English Joke 2</button>
                <button class="quick-action-btn" onclick="tellJoke('english', 2)">English Joke 3</button>
            </div>
        </div>
    </div>

    <div class="modal" id="motivationModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Motivation / ‡§™‡•ç‡§∞‡•á‡§∞‡§£‡§æ</div>
                <button class="close-btn" onclick="closeModal('motivationModal')">√ó</button>
            </div>
            <div class="quick-actions">
                <button class="quick-action-btn" onclick="getMotivation('hindi')">‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§™‡•ç‡§∞‡•á‡§∞‡§£‡§æ</button>
                <button class="quick-action-btn" onclick="getMotivation('english')">English Motivation</button>
                <button class="quick-action-btn" onclick="getRandomMotivation()">Random / ‡§Ø‡§æ‡§¶‡•É‡§ö‡•ç‡§õ‡§ø‡§ï</button>
            </div>
        </div>
    </div>

    <script>
        // Knowledge Base
        const knowledgeBase = {
            greetings: {
                en: "Hello! I'm Tejas AI. You can speak to me or type. I understand both English and Hindi!",
                hi: "‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§§‡•á‡§ú‡§∏ ‡§è‡§Ü‡§à ‡§π‡•Ç‡§Ç‡•§ ‡§Ü‡§™ ‡§Æ‡•Å‡§ù‡§∏‡•á ‡§¨‡•ã‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§Ø‡§æ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Æ‡•à‡§Ç ‡§Ö‡§Ç‡§ó‡•ç‡§∞‡•á‡§ú‡•Ä ‡§î‡§∞ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§∏‡§Æ‡§ù‡§§‡§æ ‡§π‡•Ç‡§Ç!"
            },
            
            stories: {
                hindi: [
                    "‡§è‡§ï ‡§ó‡§æ‡§Å‡§µ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§ï‡§ø‡§∏‡§æ‡§® ‡§∞‡§π‡§§‡§æ ‡§•‡§æ‡•§ ‡§è‡§ï ‡§¨‡§æ‡§∞ ‡§â‡§∏‡§ï‡•á ‡§ñ‡•á‡§§ ‡§Æ‡•á‡§Ç ‡§¨‡§π‡•Å‡§§ ‡§∏‡§æ‡§∞‡•á ‡§§‡§∞‡§¨‡•Ç‡§ú ‡§â‡§ó‡•á‡•§ ‡§â‡§∏‡§®‡•á ‡§∏‡•ã‡§ö‡§æ ‡§ï‡§ø ‡§∂‡§π‡§∞ ‡§ú‡§æ‡§ï‡§∞ ‡§á‡§®‡•ç‡§π‡•á‡§Ç ‡§¨‡•á‡§ö‡•Ç‡§Ç‡§ó‡§æ‡•§ ‡§∞‡§æ‡§∏‡•ç‡§§‡•á ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§®‡§¶‡•Ä ‡§™‡§°‡§º‡•Ä‡•§ ‡§®‡§¶‡•Ä ‡§™‡§æ‡§∞ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§ï‡•Å‡§õ ‡§§‡§∞‡§¨‡•Ç‡§ú ‡§¨‡§π ‡§ó‡§è‡•§ ‡§ï‡§ø‡§∏‡§æ‡§® ‡§®‡•á ‡§π‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§æ‡§®‡•Ä ‡§î‡§∞ ‡§¨‡§ö‡•á ‡§π‡•Å‡§è ‡§§‡§∞‡§¨‡•Ç‡§ú ‡§¨‡•á‡§ö‡§ï‡§∞ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§™‡•à‡§∏‡§æ ‡§ï‡§Æ‡§æ‡§Ø‡§æ‡•§ ‡§á‡§∏ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•á ‡§π‡§Æ‡•á‡§Ç ‡§∏‡•Ä‡§ñ ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à ‡§ï‡§ø ‡§π‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§æ‡§®‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§",
                    
                    "‡§è‡§ï ‡§≤‡§ï‡§°‡§º‡§π‡§æ‡§∞‡§æ ‡§∞‡•ã‡§ú ‡§ú‡§Ç‡§ó‡§≤ ‡§∏‡•á ‡§≤‡§ï‡§°‡§º‡§ø‡§Ø‡§æ‡§Ç ‡§ï‡§æ‡§ü‡§ï‡§∞ ‡§≤‡§æ‡§§‡§æ ‡§î‡§∞ ‡§¨‡•á‡§ö‡§§‡§æ‡•§ ‡§è‡§ï ‡§¶‡§ø‡§® ‡§â‡§∏‡§ï‡•Ä ‡§ï‡•Å‡§≤‡•ç‡§π‡§æ‡§°‡§º‡•Ä ‡§®‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§ó‡§ø‡§∞ ‡§ó‡§à‡•§ ‡§µ‡§π ‡§∞‡•ã‡§®‡•á ‡§≤‡§ó‡§æ‡•§ ‡§§‡§≠‡•Ä ‡§è‡§ï ‡§¶‡•á‡§µ‡§§‡§æ ‡§™‡•ç‡§∞‡§ï‡§ü ‡§π‡•Å‡§è ‡§î‡§∞ ‡§∏‡•ã‡§®‡•á ‡§ï‡•Ä ‡§ï‡•Å‡§≤‡•ç‡§π‡§æ‡§°‡§º‡•Ä ‡§≤‡§æ‡§ï‡§∞ ‡§¶‡•Ä‡•§ ‡§≤‡§ï‡§°‡§º‡§π‡§æ‡§∞‡•á ‡§®‡•á ‡§ï‡§π‡§æ, '‡§Ø‡§π ‡§Æ‡•á‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§' ‡§¶‡•á‡§µ‡§§‡§æ ‡§®‡•á ‡§â‡§∏‡§ï‡•Ä ‡§à‡§Æ‡§æ‡§®‡§¶‡§æ‡§∞‡•Ä ‡§∏‡•á ‡§ñ‡•Å‡§∂ ‡§π‡•ã‡§ï‡§∞ ‡§§‡•Ä‡§®‡•ã‡§Ç ‡§ï‡•Å‡§≤‡•ç‡§π‡§æ‡§°‡§º‡§ø‡§Ø‡§æ‡§Ç ‡§â‡§∏‡•á ‡§¶‡•á ‡§¶‡•Ä‡§Ç‡•§ ‡§à‡§Æ‡§æ‡§®‡§¶‡§æ‡§∞‡•Ä ‡§ï‡§æ ‡§´‡§≤ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§Æ‡•Ä‡§†‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§",
                    
                    "‡§è‡§ï ‡§ú‡§Ç‡§ó‡§≤ ‡§Æ‡•á‡§Ç ‡§ñ‡§∞‡§ó‡•ã‡§∂ ‡§î‡§∞ ‡§ï‡§õ‡•Å‡§Ü ‡§ó‡§π‡§∞‡•á ‡§¶‡•ã‡§∏‡•ç‡§§ ‡§•‡•á‡•§ ‡§è‡§ï ‡§¶‡§ø‡§® ‡§¨‡§æ‡§ò ‡§®‡•á ‡§ñ‡§∞‡§ó‡•ã‡§∂ ‡§ï‡•ã ‡§™‡§ï‡§°‡§º ‡§≤‡§ø‡§Ø‡§æ‡•§ ‡§ï‡§õ‡•Å‡§Ü ‡§ß‡•Ä‡§∞‡•á-‡§ß‡•Ä‡§∞‡•á ‡§ö‡§≤‡§ï‡§∞ ‡§¨‡§æ‡§ò ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§™‡§π‡•Å‡§Ç‡§ö‡§æ ‡§î‡§∞ ‡§â‡§∏‡•á ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ‡•§ ‡§¨‡§æ‡§ò ‡§®‡•á ‡§ñ‡§∞‡§ó‡•ã‡§∂ ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º ‡§¶‡§ø‡§Ø‡§æ‡•§ ‡§á‡§∏‡§∏‡•á ‡§™‡§§‡§æ ‡§ö‡§≤‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§¶‡•ã‡§∏‡•ç‡§§‡•Ä ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§ï‡§Æ‡§ú‡•ã‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•Ä, ‡§¨‡§≤‡•ç‡§ï‡§ø ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§ó‡•Å‡§£ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§Æ‡§ø‡§≤‡§ï‡§∞ ‡§ï‡§æ‡§Æ ‡§Ü‡§§‡•á ‡§π‡•à‡§Ç‡•§"
                ],
                english: [
                    "In a village lived a farmer. One season, his field produced many watermelons. He decided to sell them in the city. On the way, he had to cross a river. While crossing, some watermelons fell into the river. The farmer didn't give up and sold the remaining watermelons to earn good money. This story teaches us never to give up.",
                    
                    "A woodcutter would cut wood from the forest daily and sell it. One day, his axe fell into the river. He started crying. Suddenly, a god appeared and brought a golden axe. The woodcutter said, 'This is not mine.' Pleased with his honesty, the god gave him all three axes. Honesty is always rewarded.",
                    
                    "In a forest, a rabbit and a turtle were best friends. One day, a tiger caught the rabbit. The turtle slowly reached the tiger and convinced him to let the rabbit go. This shows that friendship has different qualities that work together when needed."
                ]
            },
            
            jokes: {
                hindi: [
                    "‡§ü‡•Ä‡§ö‡§∞: '‡§¨‡§ö‡•ç‡§ö‡•ã‡§Ç, 2 ‡§î‡§∞ 2 ‡§ï‡§ø‡§§‡§®‡•á ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç?' ‡§∏‡•ç‡§ü‡•Ç‡§°‡•á‡§Ç‡§ü: '4!' ‡§ü‡•Ä‡§ö‡§∞: '‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ö‡•ç‡§õ‡§æ! ‡§î‡§∞ 2 ‡§î‡§∞ 2 ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•á ‡§§‡•ã?' ‡§∏‡•ç‡§ü‡•Ç‡§°‡•á‡§Ç‡§ü: '‡§´‡§ø‡§∞ ‡§§‡•ã ‡§Æ‡•á‡§∞‡•á ‡§Æ‡§æ‡§∞‡•ç‡§ï‡•ç‡§∏ ‡§ï‡§Æ ‡§Ü‡§§‡•á!'",
                    
                    "‡§™‡§æ‡§™‡§æ: '‡§¨‡•á‡§ü‡§æ, ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•Ä ‡§Ü‡§Å‡§ñ‡•á‡§Ç ‡§á‡§§‡§®‡•Ä ‡§≤‡§æ‡§≤ ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§π‡•à‡§Ç?' ‡§¨‡•á‡§ü‡§æ: '‡§™‡§æ‡§™‡§æ, ‡§Æ‡•à‡§Ç‡§®‡•á ‡§∏‡•Å‡§®‡§æ ‡§π‡•à ‡§ï‡§ø ‡§∞‡§æ‡§§ ‡§Æ‡•á‡§Ç ‡§™‡§¢‡§º‡§®‡•á ‡§∏‡•á ‡§Ü‡§Å‡§ñ‡•á‡§Ç ‡§ñ‡§∞‡§æ‡§¨ ‡§π‡•ã ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§á‡§∏‡§≤‡§ø‡§è ‡§Æ‡•à‡§Ç ‡§¶‡§ø‡§® ‡§Æ‡•á‡§Ç ‡§™‡§¢‡§º‡§§‡§æ ‡§π‡•Ç‡§Ç!' ‡§™‡§æ‡§™‡§æ: '‡§§‡•ã ‡§´‡§ø‡§∞ ‡§≤‡§æ‡§≤ ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§π‡•à‡§Ç?' ‡§¨‡•á‡§ü‡§æ: '‡§¶‡§ø‡§® ‡§Æ‡•á‡§Ç ‡§∏‡•ã‡§®‡•á ‡§∏‡•á!'",
                    
                    "‡§è‡§ï ‡§Ü‡§¶‡§Æ‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§ó‡§Ø‡§æ: '‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§∏‡§æ‡§π‡§¨, ‡§Æ‡•Å‡§ù‡•á ‡§Ø‡§æ‡§¶‡§¶‡§æ‡§∂‡•ç‡§§ ‡§ï‡•Ä problem ‡§π‡•à‡•§' ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§®‡•á ‡§™‡•Ç‡§õ‡§æ: '‡§ï‡§¨ ‡§∏‡•á?' ‡§Ü‡§¶‡§Æ‡•Ä ‡§¨‡•ã‡§≤‡§æ: '‡§ï‡§¨ ‡§∏‡•á ‡§ï‡•ç‡§Ø‡§æ?'"
                ],
                english: [
                    "Teacher: 'Children, how much is 2+2?' Student: '4!' Teacher: 'Very good! And if it wasn't 2+2?' Student: 'Then my marks would be less!'",
                    
                    "Father: 'Son, why are your eyes so red?' Son: 'Dad, I heard that studying at night spoils eyes, so I study during the day!' Father: 'Then why are they red?' Son: 'From sleeping during the day!'",
                    
                    "A man went to the doctor: 'Doctor, I have a memory problem.' Doctor asked: 'Since when?' Man said: 'Since when what?'"
                ]
            },
            
            motivation: {
                hindi: [
                    "‡§∏‡§´‡§≤‡§§‡§æ ‡§â‡§®‡•ç‡§π‡•Ä‡§Ç ‡§ï‡•ã ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à ‡§ú‡•ã ‡§ï‡§†‡§ø‡§®‡§æ‡§á‡§Ø‡•ã‡§Ç ‡§∏‡•á ‡§ò‡§¨‡§∞‡§æ‡§§‡•á ‡§®‡§π‡•Ä‡§Ç, ‡§¨‡§≤‡•ç‡§ï‡§ø ‡§â‡§®‡§ï‡§æ ‡§∏‡§æ‡§Æ‡§®‡§æ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç!",
                    "‡§ú‡•Ä‡§µ‡§® ‡§Æ‡•á‡§Ç ‡§ï‡§≠‡•Ä ‡§π‡§æ‡§∞ ‡§Æ‡§§ ‡§Æ‡§æ‡§®‡•ã, ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§π‡•Ä ‡§á‡§Ç‡§¶‡•ç‡§∞‡§ß‡§®‡•Å‡§∑ ‡§¶‡§ø‡§ñ‡§§‡§æ ‡§π‡•à!",
                    "‡§Æ‡•á‡§π‡§®‡§§ ‡§ï‡§∞‡•ã, ‡§∏‡§™‡§®‡•á ‡§¶‡•á‡§ñ‡•ã, ‡§î‡§∞ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§∞‡§ñ‡•ã - ‡§∏‡§´‡§≤‡§§‡§æ ‡§ú‡§∞‡•Ç‡§∞ ‡§Æ‡§ø‡§≤‡•á‡§ó‡•Ä!"
                ],
                english: [
                    "Success comes to those who don't fear difficulties but face them!",
                    "Never give up in life, because rainbow appears only after rain!",
                    "Work hard, dream big, and keep faith - success will definitely come!"
                ]
            }
        };

        let isListening = false;
        let voiceEnabled = true;
        let recognition;
        let currentLanguage = 'en';

        // Initialize
        window.addEventListener('load', function() {
            initializeSpeechRecognition();
            addMessage(knowledgeBase.greetings.en, 'bot', true);
        });

        function initializeSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.maxAlternatives = 1;

                recognition.onstart = function() {
                    isListening = true;
                    document.getElementById('voiceButton').classList.add('listening');
                    document.getElementById('listeningStatus').style.display = 'block';
                };

                recognition.onresult = function(event) {
                    const speechResult = event.results[0][0].transcript;
                    document.getElementById('userInput').value = speechResult;
                    detectLanguage(speechResult);
                    sendMessage();
                };

                recognition.onerror = function(event) {
                    console.error('Speech recognition error', event.error);
                    stopListening();
                };

                recognition.onend = function() {
                    stopListening();
                };
            } else {
                alert("Speech recognition not supported in this browser. Please use Chrome or Edge.");
            }
        }

        function detectLanguage(text) {
            const hindiRegex = /[\u0900-\u097F]/;
            currentLanguage = hindiRegex.test(text) ? 'hi' : 'en';
        }

        function toggleListening() {
            if (!isListening) {
                startListening();
            } else {
                stopListening();
            }
        }

        function startListening() {
            if (recognition) {
                recognition.lang = currentLanguage === 'hi' ? 'hi-IN' : 'en-US';
                recognition.start();
            }
        }

        function stopListening() {
            if (recognition) {
                recognition.stop();
            }
            isListening = false;
            document.getElementById('voiceButton').classList.remove('listening');
            document.getElementById('listeningStatus').style.display = 'none';
        }

        function sendMessage() {
            const input = document.getElementById('userInput');
            const userText = input.value.trim();
            
            if (!userText) return;

            // Add user message
            addMessage(userText, 'user');
            
            // Detect language from user input
            detectLanguage(userText);
            
            // Show typing indicator
            showTypingIndicator();
            
            // Generate response after delay
            setTimeout(() => {
                const response = generateResponse(userText);
                addMessage(response, 'bot', true);
            }, 1000);

            input.value = "";
        }

        function generateResponse(userInput) {
            const userText = userInput.toLowerCase();
            
            // Simple response logic - can be expanded
            if (userText.includes('hello') || userText.includes('hi') || userText.includes('‡§®‡§Æ‡§∏‡•ç‡§§‡•á') || userText.includes('‡§π‡•à‡§≤‡•ã')) {
                return currentLanguage === 'hi' ? 
                    "‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§§‡•á‡§ú‡§∏ ‡§è‡§Ü‡§à ‡§π‡•Ç‡§Ç‡•§ ‡§Ü‡§™ ‡§Æ‡•Å‡§ù‡§∏‡•á ‡§¨‡•ã‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§Ø‡§æ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§" :
                    "Hello! I'm Tejas AI. You can speak to me or type.";
            }
            
            if (userText.includes('story') || userText.includes('‡§ï‡§π‡§æ‡§®‡•Ä')) {
                return currentLanguage === 'hi' ?
                    "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§è‡§ï ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡•Ç‡§Ç‡§ó‡§æ! ‚ãØ ‡§Æ‡•á‡§®‡•Ç ‡§∏‡•á ‡§ï‡§π‡§æ‡§®‡•Ä ‡§ö‡•Å‡§®‡•á‡§Ç‡•§" :
                    "I'd love to tell you a good story! Choose a story from the ‚ãØ menu.";
            }
            
            if (userText.includes('joke') || userText.includes('‡§ö‡•Å‡§ü‡§ï‡•Å‡§≤‡§æ')) {
                return currentLanguage === 'hi' ?
                    "‡§π‡§Ç‡§∏‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞? ‚ãØ ‡§Æ‡•á‡§®‡•Ç ‡§∏‡•á ‡§ö‡•Å‡§ü‡§ï‡•Å‡§≤‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç!" :
                    "Ready for laughter? Choose a joke from the ‚ãØ menu!";
            }
            
            // Default response
            return currentLanguage === 'hi' ?
                "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡•à‡§∏‡•á ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç? ‡§Ü‡§™ ‚ãØ ‡§Æ‡•á‡§®‡•Ç ‡§∏‡•á ‡§∏‡•ç‡§ü‡•ã‡§∞‡•Ä, ‡§ú‡•ã‡§ï‡•ç‡§∏ ‡§Ø‡§æ ‡§Æ‡•ã‡§ü‡§ø‡§µ‡•á‡§∂‡§® ‡§ö‡•Å‡§® ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç!" :
                "How can I help you? You can choose stories, jokes or motivation from the ‚ãØ menu!";
        }

        function addMessage(content, role, speak = false) {
            const chat = document.getElementById('chat');
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
            
            if (role === 'user') {
                chat.innerHTML += `
                    <div class="message user-message">
                        <div class="message-content">${content}</div>
                        <div class="message-avatar user-avatar">üë§</div>
                    </div>
                `;
            } else {
                chat.innerHTML += `
                    <div class="message bot-message">
                        <div class="message-avatar bot-avatar">ü§ñ</div>
                        <div class="message-content">${content}</div>
                    </div>
                `;
                
                // Speak the response if voice is enabled
                if (speak && voiceEnabled) {
                    speakText(content);
                }
            }
            chat.scrollTop = chat.scrollHeight;
        }

        function showTypingIndicator() {
            const chat = document.getElementById('chat');
            chat.innerHTML += `
                <div class="message bot-message" id="typingIndicator">
                    <div class="message-avatar bot-avatar">ü§ñ</div>
                    <div class="message-content">
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            `;
            chat.scrollTop = chat.scrollHeight;
        }

        function speakText(text) {
            // Remove emojis and special characters for cleaner speech
            const cleanText = text.replace(/[^\w\s\u0900-\u097F.,!?;]/g, '');
            const utterance = new SpeechSynthesisUtterance(cleanText);
            utterance.lang = currentLanguage === 'hi' ? 'hi-IN' : 'en-US';
            utterance.rate = 0.9;
            utterance.pitch = 1.0;
            window.speechSynthesis.speak(utterance);
        }

        // Menu Functions
        function toggleMenu() {
            const menu = document.getElementById('dropdownMenu');
            menu.classList.toggle('show');
        }

        function showStories() {
            closeAllModals();
            document.getElementById('storiesModal').classList.add('show');
            toggleMenu();
        }

        function showJokes() {
            closeAllModals();
            document.getElementById('jokesModal').classList.add('show');
            toggleMenu();
        }

        function showMotivation() {
            closeAllModals();
            document.getElementById('motivationModal').classList.add('show');
            toggleMenu();
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        function closeAllModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('show');
            });
        }

        // Content Functions
        function tellStory(language, index) {
            const story = knowledgeBase.stories[language][index];
            const title = language === 'hindi' ? 
                ['‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§Æ‡§æ‡§® ‡§ï‡§ø‡§∏‡§æ‡§®', '‡§à‡§Æ‡§æ‡§®‡§¶‡§æ‡§∞ ‡§≤‡§ï‡§°‡§º‡§π‡§æ‡§∞‡§æ', '‡§¶‡•ã‡§∏‡•ç‡§§‡•Ä ‡§ï‡•Ä ‡§∂‡§ï‡•ç‡§§‡§ø'][index] :
                ['The Wise Farmer', 'Honest Woodcutter', 'Power of Friendship'][index];
            
            addMessage(`üìñ ${title}\n\n${story}`, 'bot', true);
            closeModal('storiesModal');
        }

        function tellJoke(language, index) {
            const joke = knowledgeBase.jokes[language][index];
            addMessage(`üòÇ ${joke}`, 'bot', true);
            closeModal('jokesModal');
        }

        function getMotivation(language) {
            const quotes = knowledgeBase.motivation[language];
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            addMessage(`üí´ ${randomQuote}`, 'bot', true);
            closeModal('motivationModal');
        }

        function getRandomMotivation() {
            const allQuotes = [...knowledgeBase.motivation.hindi, ...knowledgeBase.motivation.english];
            const randomQuote = allQuotes[Math.floor(Math.random() * allQuotes.length)];
            addMessage(`üí´ ${randomQuote}`, 'bot', true);
            closeModal('motivationModal');
        }

        function toggleVoice() {
            voiceEnabled = !voiceEnabled;
            document.getElementById('voiceStatus').textContent = voiceEnabled ? 'Voice On' : 'Voice Off';
            toggleMenu();
            
            // Give feedback
            const feedback = voiceEnabled ? 
                (currentLanguage === 'hi' ? "‡§Ü‡§µ‡§æ‡§ú ‡§ö‡§æ‡§≤‡•Ç ‡§π‡•ã ‡§ó‡§à ‡§π‡•à!" : "Voice turned on!") :
                (currentLanguage === 'hi' ? "‡§Ü‡§µ‡§æ‡§ú ‡§¨‡§Ç‡§¶ ‡§π‡•ã ‡§ó‡§à ‡§π‡•à!" : "Voice turned off!");
            
            addMessage(feedback, 'bot', false);
        }

        function saveChatAsPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const chatText = document.getElementById('chat').innerText;
            doc.text(chatText, 10, 10);
            doc.save('tejas_chat.pdf');
            addMessage(currentLanguage === 'hi' ? 
                "‚úÖ ‡§ö‡•à‡§ü PDF ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§π‡•ã ‡§ó‡§à!" : 
                "‚úÖ Chat saved as PDF!", 'bot');
            toggleMenu();
        }

        function clearChat() {
            document.getElementById('chat').innerHTML = `
                <div class="message bot-message">
                    <div class="message-avatar bot-avatar">ü§ñ</div>
                    <div class="message-content">
                        ${currentLanguage === 'hi' ? 
                            "‡§ö‡•à‡§ü ‡§∏‡§æ‡§´ ‡§π‡•ã ‡§ó‡§à! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•à‡§∏‡•á ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç?" : 
                            "Chat cleared! How can I help you today?"}
                    </div>
                </div>
            `;
            toggleMenu();
        }

        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('dropdownMenu');
            const menuBtn = document.querySelector('.menu-btn');
            
            if (!menu.contains(event.target) && !menuBtn.contains(event.target)) {
                menu.classList.remove('show');
            }
        });
    </script>
</body>
</html>
