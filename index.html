<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>Jigyasa - Advanced AI Chatbot</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .avatar-container {
            position: relative;
            display: inline-block;
        }

        .avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 5px solid #4CAF50;
            animation: float 3s ease-in-out infinite;
        }

        .status-indicator {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 20px;
            height: 20px;
            background: #4CAF50;
            border-radius: 50%;
            border: 3px solid white;
            animation: pulse 2s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            min-width: 200px;
        }

        select, button, input[type="range"] {
            padding: 12px 15px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .main-content {
            display: flex;
            gap: 20px;
            flex: 1;
        }

        .sidebar {
            width: 300px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .user-profile {
            text-align: center;
            margin-bottom: 20px;
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .quick-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quick-action-btn {
            padding: 12px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .quick-action-btn:hover {
            background: #667eea;
            color: white;
            transform: translateX(5px);
        }

        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .chat-box {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            max-height: 500px;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            animation: messageAppear 0.3s ease;
        }

        @keyframes messageAppear {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            justify-content: flex-end;
        }

        .bot-message {
            justify-content: flex-start;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
        }

        .user-msg-avatar {
            background: #667eea;
        }

        .bot-msg-avatar {
            background: #4CAF50;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            position: relative;
        }

        .user-message .message-content {
            background: #667eea;
            color: white;
            border-bottom-right-radius: 5px;
        }

        .bot-message .message-content {
            background: white;
            color: #333;
            border: 1px solid #e9ecef;
            border-bottom-left-radius: 5px;
        }

        .message-time {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 5px;
        }

        .typing-indicator {
            display: none;
            padding: 10px 16px;
            background: white;
            border-radius: 18px;
            border: 1px solid #e9ecef;
            margin-bottom: 15px;
        }

        .typing-dots {
            display: flex;
            gap: 3px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        .input-container {
            padding: 20px;
            background: white;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .message-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
        }

        .message-input:focus {
            border-color: #667eea;
        }

        .send-btn, .mic-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .send-btn:hover, .mic-btn:hover {
            transform: scale(1.1);
        }

        .mic-btn.listening {
            background: #ff4757;
            animation: pulse 1s infinite;
        }

        .quick-replies {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .quick-reply {
            padding: 8px 16px;
            background: #f1f3f4;
            border: none;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-reply:hover {
            background: #667eea;
            color: white;
        }

        .games-container {
            display: none;
            padding: 20px;
            background: white;
            border-radius: 15px;
            margin-top: 20px;
        }

        .game-option {
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }

        .game-option:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .dark-mode {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: #ecf0f1;
        }

        .dark-mode .header,
        .dark-mode .controls,
        .dark-mode .sidebar,
        .dark-mode .chat-container {
            background: rgba(44, 62, 80, 0.95);
            color: #ecf0f1;
        }

        .dark-mode .message-input {
            background: #34495e;
            border-color: #4a6572;
            color: #ecf0f1;
        }

        .dark-mode .bot-message .message-content {
            background: #34495e;
            color: #ecf0f1;
            border-color: #4a6572;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: #4CAF50;
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
            }
            .controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <div class="header">
            <div class="avatar-container">
                <img src="https://cdn-icons-png.flaticon.com/512/4712/4712035.png" alt="Jigyasa Avatar" class="avatar">
                <div class="status-indicator"></div>
            </div>
            <h1>Jigyasa - AI Assistant</h1>
            <p>Your intelligent Hindi-speaking companion</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <label>Voice Settings</label>
                <select id="voiceType">
                    <option value="female">üë© Female Voice</option>
                    <option value="male">üë® Male Voice</option>
                </select>
                <input type="range" id="voiceSpeed" min="0.5" max="2" step="0.1" value="1">
                <span>Speed: <span id="speedValue">1.0</span></span>
            </div>

            <div class="control-group">
                <label>Personality</label>
                <select id="personality">
                    <option value="friendly">üòä Friendly</option>
                    <option value="professional">üíº Professional</option>
                    <option value="funny">üòÑ Funny</option>
                    <option value="teacher">üë©‚Äçüè´ Teacher</option>
                </select>
            </div>

            <div class="control-group">
                <label>Theme</label>
                <button onclick="toggleTheme()">üåô Dark Mode</button>
                <button onclick="changeBackground()">üé® Change Background</button>
            </div>

            <div class="control-group">
                <label>Tools</label>
                <button onclick="showGames()">üéÆ Games</button>
                <button onclick="showCalculator()">üßÆ Calculator</button>
                <button onclick="showConverter()">üìê Converter</button>
            </div>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <div class="user-profile">
                    <div class="user-avatar">üë§</div>
                    <h3 id="userName">Guest User</h3>
                    <p>Chat Level: <span id="userLevel">Beginner</span></p>
                </div>

                <div class="quick-actions">
                    <button class="quick-action-btn" onclick="quickAction('weather')">üå§Ô∏è Weather Info</button>
                    <button class="quick-action-btn" onclick="quickAction('joke')">üòÑ Tell me a Joke</button>
                    <button class="quick-action-btn" onclick="quickAction('fact')">üìö Interesting Fact</button>
                    <button class="quick-action-btn" onclick="quickAction('quote')">üí´ Daily Quote</button>
                    <button class="quick-action-btn" onclick="quickAction('news')">üì∞ Today's News</button>
                    <button class="quick-action-btn" onclick="quickAction('story')">üìñ Short Story</button>
                    <button class="quick-action-btn" onclick="quickAction('calculator')">üßÆ Open Calculator</button>
                    <button class="quick-action-btn" onclick="quickAction('converter')">üìê Unit Converter</button>
                </div>

                <div class="user-stats">
                    <h4>Today's Activity</h4>
                    <p>Messages: <span id="messageCount">0</span></p>
                    <p>Session Time: <span id="sessionTime">00:00</span></p>
                </div>
            </div>

            <div class="chat-container">
                <div class="chat-header">
                    <h2>üí¨ Chat with Jigyasa</h2>
                    <p>Ask me anything in Hindi or English!</p>
                </div>

                <div class="chat-box" id="chatBox">
                    <div class="message bot-message">
                        <div class="message-avatar bot-msg-avatar">J</div>
                        <div class="message-content">
                            ‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç Jigyasa ‡§π‡•Ç‡§Å, ‡§Ü‡§™‡§ï‡•Ä AI ‡§∏‡§π‡§æ‡§Ø‡§ï‡•§ ‡§Æ‡•à‡§Ç ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§î‡§∞ ‡§Ö‡§Ç‡§ó‡•ç‡§∞‡•á‡§ú‡•Ä ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•Ç‡§Å‡•§ ‡§Ü‡§™ ‡§Æ‡•Å‡§ù‡§∏‡•á ‡§ï‡•Å‡§õ ‡§≠‡•Ä ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç!
                            <div class="message-time" id="currentTime"></div>
                        </div>
                    </div>
                </div>

                <div class="typing-indicator" id="typingIndicator">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>

                <div class="input-container">
                    <input type="text" class="message-input" id="messageInput" 
                           placeholder="Type your message here..." 
                           onkeypress="handleKeyPress(event)">
                    <button class="mic-btn" id="micButton" onclick="toggleListening()">üé§</button>
                    <button class="send-btn" onclick="sendMessage()">‚û§</button>
                </div>

                <div class="quick-replies" id="quickReplies">
                    <button class="quick-reply" onclick="quickReply('hello')">‡§®‡§Æ‡§∏‡•ç‡§§‡•á</button>
                    <button class="quick-reply" onclick="quickReply('how_are_you')">‡§ï‡•à‡§∏‡•á ‡§π‡•ã?</button>
                    <button class="quick-reply" onclick="quickReply('time')">‡§∏‡§Æ‡§Ø ‡§¨‡§§‡§æ‡§ì</button>
                    <button class="quick-reply" onclick="quickReply('joke')">‡§ú‡•ã‡§ï ‡§∏‡•Å‡§®‡§æ‡§ì</button>
                    <button class="quick-reply" onclick="quickReply('weather')">‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•à‡§∏‡§æ ‡§π‡•à?</button>
                </div>
            </div>
        </div>

        <div class="games-container" id="gamesContainer">
            <h3>üéÆ Mini Games</h3>
            <div class="game-option" onclick="startGame('quiz')">üß† ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡•ç‡§µ‡§ø‡§ú</div>
            <div class="game-option" onclick="startGame('riddle')">ü§î ‡§™‡§π‡•á‡§≤‡§ø‡§Ø‡§æ‡§Å</div>
            <div class="game-option" onclick="startGame('math')">‚ûó ‡§ó‡§£‡§ø‡§§ ‡§ï‡•á ‡§∏‡§µ‡§æ‡§≤</div>
            <div class="game-option" onclick="startGame('word')">üî§ ‡§∂‡§¨‡•ç‡§¶ ‡§ñ‡•á‡§≤</div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Advanced configuration
        const CONFIG = {
            ai: {
                enabled: true,
                contextMemory: 10,
                learningRate: 0.1
            },
            voice: {
                enabled: true,
                defaultSpeed: 1,
                languages: ['hi-IN', 'en-US']
            },
            storage: {
                enabled: true,
                encryption: true,
                backupInterval: 300000
            }
        };

        // Enhanced Q&A database
        const KNOWLEDGE_BASE = {
            // Hindi greetings and basic queries
            "‡§®‡§Æ‡§∏‡•ç‡§§‡•á": "‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç Jigyasa ‡§π‡•Ç‡§Å‡•§ ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•Ç‡§Å?",
            "‡§π‡•à‡§≤‡•ã": "‡§π‡•à‡§≤‡•ã! ‡§ï‡•à‡§∏‡•á ‡§π‡•ã ‡§Ü‡§™?",
            "‡§ï‡•à‡§∏‡•á ‡§π‡•ã": "‡§Æ‡•à‡§Ç ‡§¨‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§†‡•Ä‡§ï ‡§π‡•Ç‡§Å, ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶! ‡§Ü‡§™ ‡§∏‡•Å‡§®‡§æ‡§á‡§è?",
            "‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à": "‡§Æ‡•á‡§∞‡§æ ‡§®‡§æ‡§Æ Jigyasa ‡§π‡•à, ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à '‡§ú‡§ø‡§ú‡•ç‡§û‡§æ‡§∏‡§æ'!",
            "‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶": "‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à! ‡§ï‡•ã‡§à ‡§î‡§∞ ‡§Æ‡§¶‡§¶ ‡§ö‡§æ‡§π‡§ø‡§è?",
            
            // English queries
            "hello": "Hello! I'm Jigyasa, your AI assistant. How can I help you today?",
            "how are you": "I'm doing great, thank you! How about you?",
            "what is your name": "My name is Jigyasa, which means 'curiosity' in Hindi!",
            "thank you": "You're welcome! Is there anything else I can help with?",
            
            // Weather and time
            "‡§Æ‡•å‡§∏‡§Æ": "‡§Æ‡•à‡§Ç real-time ‡§Æ‡•å‡§∏‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§§‡§æ ‡§∏‡§ï‡§§‡•Ä, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ü‡§™ weather app check ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç",
            "‡§∏‡§Æ‡§Ø": `‡§Ö‡§≠‡•Ä ‡§∏‡§Æ‡§Ø ‡§π‡•à: ${new Date().toLocaleTimeString('hi-IN')}`,
            "‡§§‡§æ‡§∞‡•Ä‡§ñ": `‡§Ü‡§ú ‡§ï‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ: ${new Date().toLocaleDateString('hi-IN')}`,
            
            // Jokes
            "‡§ú‡•ã‡§ï": getRandomJoke(),
            "‡§ö‡•Å‡§ü‡§ï‡•Å‡§≤‡§æ": getRandomJoke(),
            "‡§π‡§Ç‡§∏‡§æ‡§ì": getRandomJoke(),
            
            // Facts
            "‡§§‡§•‡•ç‡§Ø": getRandomFact(),
            "‡§∞‡•ã‡§ö‡§ï ‡§§‡§•‡•ç‡§Ø": getRandomFact(),
            "‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä": getRandomFact(),
            
            // Stories
            "‡§ï‡§π‡§æ‡§®‡•Ä": getRandomStory(),
            "‡§∏‡•ç‡§ü‡•ã‡§∞‡•Ä": getRandomStory(),
            
            // Help
            "‡§Æ‡§¶‡§¶": "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä these ‡§ö‡•Ä‡§ú‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•Ç‡§Å: ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§, ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä, ‡§Æ‡§®‡•ã‡§∞‡§Ç‡§ú‡§®, ‡§ó‡§£‡§®‡§æ, ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞‡§£, ‡§î‡§∞ ‡§¨‡§π‡•Å‡§§ ‡§ï‡•Å‡§õ!",
            "help": "I can help you with: conversation, information, entertainment, calculations, conversions, and much more!"
        };

        // Advanced responses database
        const ADVANCED_RESPONSES = {
            jokes: [
                "‡§è‡§ï ‡§Ü‡§¶‡§Æ‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§ó‡§Ø‡§æ: '‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§∏‡§æ‡§π‡§¨, ‡§Æ‡•Å‡§ù‡•á ‡§≠‡•Ç‡§≤‡§®‡•á ‡§ï‡•Ä ‡§¨‡•Ä‡§Æ‡§æ‡§∞‡•Ä ‡§π‡•à‡•§' ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§¨‡•ã‡§≤‡•á: '‡§ï‡§¨ ‡§∏‡•á?' ‡§Ü‡§¶‡§Æ‡•Ä ‡§¨‡•ã‡§≤‡§æ: '‡§ï‡§¨ ‡§∏‡•á ‡§ï‡•ç‡§Ø‡§æ?'",
                "‡§ü‡•Ä‡§ö‡§∞: '‡§¨‡§ö‡•ç‡§ö‡•ã‡§Ç, 2√ó2 ‡§ï‡§ø‡§§‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à?' ‡§∏‡•ç‡§ü‡•Ç‡§°‡•á‡§Ç‡§ü: '‡§Æ‡•à‡§°‡§Æ, 4!' ‡§ü‡•Ä‡§ö‡§∞: '‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ö‡•ç‡§õ‡§æ!' ‡§∏‡•ç‡§ü‡•Ç‡§°‡•á‡§Ç‡§ü: '‡§≤‡•á‡§ï‡§ø‡§® ‡§Æ‡•à‡§°‡§Æ, ‡§Æ‡•Å‡§ù‡•á ‡§Ø‡§π ‡§¨‡§§‡§æ‡§á‡§è ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à?'",
                "‡§™‡§§‡§ø ‡§®‡•á ‡§™‡§§‡•ç‡§®‡•Ä ‡§∏‡•á ‡§™‡•Ç‡§õ‡§æ: '‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•Ä ‡§â‡§Æ‡•ç‡§∞ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?' ‡§™‡§§‡•ç‡§®‡•Ä ‡§¨‡•ã‡§≤‡•Ä: '‡§Æ‡•á‡§∞‡•Ä ‡§â‡§Æ‡•ç‡§∞ ‡§∞‡§π‡§∏‡•ç‡§Ø ‡§π‡•à!' ‡§™‡§§‡§ø: '‡§§‡•ã ‡§´‡§ø‡§∞ ‡§§‡•Å‡§Æ ‡§¨‡§π‡•Å‡§§ ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§∞‡§π‡§∏‡•ç‡§Ø ‡§π‡•ã!'"
            ],
            facts: [
                "‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§Æ‡§π‡§æ‡§∏‡§æ‡§ó‡§∞ ‡§™‡•ç‡§∞‡§∂‡§æ‡§Ç‡§§ ‡§Æ‡§π‡§æ‡§∏‡§æ‡§ó‡§∞ ‡§π‡•à, ‡§ú‡•ã ‡§™‡•É‡§•‡•ç‡§µ‡•Ä ‡§ï‡•Ä ‡§∏‡§§‡§π ‡§ï‡•á ‡§è‡§ï ‡§§‡§ø‡§π‡§æ‡§à ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§ï‡•ã ‡§ï‡§µ‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§",
                "‡§Æ‡§æ‡§®‡§µ ‡§Æ‡§∏‡•ç‡§§‡§ø‡§∑‡•ç‡§ï ‡§è‡§ï ‡§¶‡§ø‡§® ‡§Æ‡•á‡§Ç ‡§≤‡§ó‡§≠‡§ó 70,000 ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§",
                "‡§∂‡§π‡§¶ ‡§è‡§ï‡§Æ‡§æ‡§§‡•ç‡§∞ ‡§ê‡§∏‡§æ ‡§ñ‡§æ‡§¶‡•ç‡§Ø ‡§™‡§¶‡§æ‡§∞‡•ç‡§• ‡§π‡•à ‡§ú‡•ã ‡§ï‡§≠‡•Ä ‡§ñ‡§∞‡§æ‡§¨ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡§æ - archaeologists ‡§®‡•á 3000 ‡§∏‡§æ‡§≤ ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§∂‡§π‡§¶ ‡§ñ‡§æ‡§Ø‡§æ ‡§ú‡•ã ‡§Ö‡§≠‡•Ä ‡§≠‡•Ä ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§•‡§æ!"
            ],
            stories: [
                "‡§è‡§ï ‡§∏‡§Æ‡§Ø ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à, ‡§è‡§ï ‡§õ‡•ã‡§ü‡§æ ‡§∏‡§æ ‡§ó‡§æ‡§Å‡§µ ‡§•‡§æ ‡§ú‡§π‡§æ‡§Å ‡§∏‡§≠‡•Ä ‡§≤‡•ã‡§ó ‡§Æ‡§ø‡§≤‡§ú‡•Å‡§≤ ‡§ï‡§∞ ‡§∞‡§π‡§§‡•á ‡§•‡•á‡•§ ‡§è‡§ï ‡§¶‡§ø‡§® ‡§ó‡§æ‡§Å‡§µ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§ú‡§æ‡§¶‡•Ç‡§ó‡§∞ ‡§Ü‡§Ø‡§æ...",
                "‡§™‡§π‡§æ‡§°‡§º‡•ã‡§Ç ‡§ï‡•Ä ‡§ó‡•ã‡§¶ ‡§Æ‡•á‡§Ç ‡§¨‡§∏‡§æ ‡§è‡§ï ‡§õ‡•ã‡§ü‡§æ ‡§∏‡§æ ‡§ï‡§∏‡•ç‡§¨‡§æ ‡§•‡§æ‡•§ ‡§µ‡§π‡§æ‡§Å ‡§è‡§ï ‡§≤‡§°‡§º‡§ï‡§æ ‡§∞‡§π‡§§‡§æ ‡§•‡§æ ‡§ú‡§ø‡§∏‡§ï‡•Ä ‡§∏‡§¨‡§∏‡•á ‡§¨‡§°‡§º‡•Ä ‡§á‡§ö‡•ç‡§õ‡§æ ‡§•‡•Ä ‡§™‡§¢‡§º-‡§≤‡§ø‡§ñ ‡§ï‡§∞ ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§¨‡§®‡§®‡•á ‡§ï‡•Ä...",
                "‡§ú‡§Ç‡§ó‡§≤ ‡§ï‡•á ‡§∞‡§æ‡§ú‡§æ ‡§∂‡•á‡§∞ ‡§ï‡§æ ‡§ú‡§®‡•ç‡§Æ‡§¶‡§ø‡§® ‡§•‡§æ‡•§ ‡§∏‡§≠‡•Ä ‡§ú‡§æ‡§®‡§µ‡§∞ ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§¨‡§ß‡§æ‡§à ‡§¶‡•á‡§®‡•á ‡§Ü‡§è‡•§ ‡§ñ‡§∞‡§ó‡•ã‡§∂ ‡§®‡•á ‡§è‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§â‡§™‡§π‡§æ‡§∞ ‡§≤‡§æ‡§®‡•á ‡§ï‡§æ ‡§∏‡•ã‡§ö‡§æ..."
            ],
            quotes: [
                "‡§ú‡•Ä‡§µ‡§® ‡§Æ‡•á‡§Ç ‡§∏‡§´‡§≤‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§ö‡•ç‡§õ‡§æ‡§∂‡§ï‡•ç‡§§‡§ø, ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§î‡§∞ ‡§ï‡§°‡§º‡•Ä ‡§Æ‡•á‡§π‡§®‡§§ ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§",
                "‡§∏‡§Æ‡§Ø ‡§∏‡§¨‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§¶‡•Å‡§∞‡•ç‡§≠‡§æ‡§ó‡•ç‡§Ø ‡§∏‡•á ‡§Ø‡§π ‡§∏‡§≠‡•Ä ‡§õ‡§æ‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§Æ‡§æ‡§∞ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§",
                "‡§∏‡§™‡§®‡•á ‡§µ‡•ã ‡§®‡§π‡•Ä‡§Ç ‡§ú‡•ã ‡§Ü‡§™ ‡§®‡•Ä‡§Ç‡§¶ ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡•á‡§Ç, ‡§∏‡§™‡§®‡•á ‡§µ‡•ã ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§Ü‡§™‡§ï‡•ã ‡§®‡•Ä‡§Ç‡§¶ ‡§π‡•Ä ‡§® ‡§Ü‡§®‡•á ‡§¶‡•á‡§Ç‡•§"
            ]
        };

        // Game database
        const GAMES = {
            quiz: [
                {
                    question: "‡§≠‡§æ‡§∞‡§§ ‡§ï‡•Ä ‡§∞‡§æ‡§ú‡§ß‡§æ‡§®‡•Ä ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?",
                    options: ["‡§Æ‡•Å‡§Ç‡§¨‡§à", "‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä", "‡§ï‡•ã‡§≤‡§ï‡§æ‡§§‡§æ", "‡§ö‡•á‡§®‡•ç‡§®‡§à"],
                    answer: 1
                },
                {
                    question: "‡§∏‡•Ç‡§∞‡•ç‡§Ø ‡§∏‡•á ‡§™‡•É‡§•‡•ç‡§µ‡•Ä ‡§ï‡•Ä ‡§¶‡•Ç‡§∞‡•Ä ‡§ï‡§ø‡§§‡§®‡•Ä ‡§π‡•à?",
                    options: ["100 million km", "150 million km", "200 million km", "250 million km"],
                    answer: 1
                },
                {
                    question: "‡§ó‡§Ç‡§ó‡§æ ‡§®‡§¶‡•Ä ‡§ï‡§π‡§æ‡§Å ‡§∏‡•á ‡§®‡§ø‡§ï‡§≤‡§§‡•Ä ‡§π‡•à?",
                    options: ["‡§π‡§ø‡§Æ‡§æ‡§≤‡§Ø", "‡§ó‡§Ç‡§ó‡•ã‡§§‡•ç‡§∞‡•Ä", "‡§Ø‡§Æ‡•Å‡§®‡•ã‡§§‡•ç‡§∞‡•Ä", "‡§ï‡•á‡§¶‡§æ‡§∞‡§®‡§æ‡§•"],
                    answer: 1
                }
            ],
            riddles: [
                {
                    riddle: "‡§ê‡§∏‡•Ä ‡§ï‡•å‡§® ‡§∏‡•Ä ‡§ö‡•Ä‡§ú ‡§π‡•à ‡§ú‡•ã ‡§ó‡§∞‡•ç‡§Æ‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§ó‡§∞‡•ç‡§Æ ‡§î‡§∞ ‡§∏‡§∞‡•ç‡§¶‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§†‡§Ç‡§°‡•Ä ‡§∞‡§π‡§§‡•Ä ‡§π‡•à?",
                    answer: "‡§§‡§µ‡§æ"
                },
                {
                    riddle: "‡§™‡§æ‡§®‡•Ä ‡§Æ‡•á‡§Ç ‡§∞‡§π‡§ï‡§∞ ‡§≠‡•Ä ‡§™‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§¨‡•Å‡§ù‡§§‡•Ä?",
                    answer: "‡§Æ‡§õ‡§≤‡•Ä"
                },
                {
                    riddle: "‡§ê‡§∏‡§æ ‡§ï‡•å‡§® ‡§∏‡§æ ‡§´‡§≤ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§¶‡•ã ‡§®‡§æ‡§Æ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç?",
                    answer: "‡§Ö‡§®‡§æ‡§∞"
                }
            ]
        };

        // Global variables
        let chatHistory = [];
        let userProfile = {
            name: "Guest",
            level: "Beginner",
            messagesSent: 0,
            sessionStart: new Date(),
            preferences: {
                language: "hi",
                voiceEnabled: true,
                theme: "light"
            }
        };
        let isListening = false;
        let recognition;
        let sessionTimer;

        // Initialize the chatbot
        function init() {
            loadUserData();
            updateTime();
            startSessionTimer();
            setupVoiceRecognition();
            showNotification("Jigyasa started successfully! üöÄ");
            
            // Update time every second
            setInterval(updateTime, 1000);
        }

        // Load user data from localStorage
        function loadUserData() {
            const savedData = localStorage.getItem('jigyasa_user');
            if (savedData) {
                userProfile = {...userProfile, ...JSON.parse(savedData)};
                document.getElementById('userName').textContent = userProfile.name;
                document.getElementById('userLevel').textContent = userProfile.level;
                document.getElementById('messageCount').textContent = userProfile.messagesSent;
            }
        }

        // Save user data to localStorage
        function saveUserData() {
            localStorage.setItem('jigyasa_user', JSON.stringify(userProfile));
        }

        // Update current time display
        function updateTime() {
            document.getElementById('currentTime').textContent = new Date().toLocaleTimeString('hi-IN');
        }

        // Start session timer
        function startSessionTimer() {
            let seconds = 0;
            sessionTimer = setInterval(() => {
                seconds++;
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                document.getElementById('sessionTime').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // Setup voice recognition
        function setupVoiceRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'hi-IN';

                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('messageInput').value = transcript;
                    sendMessage();
                };

                recognition.onerror = function(event) {
                    console.error('Speech recognition error', event.error);
                    showNotification("Voice recognition error. Please try again.");
                };

                recognition.onend = function() {
                    isListening = false;
                    document.getElementById('micButton').classList.remove('listening');
                };
            } else {
                document.getElementById('micButton').style.display = 'none';
                showNotification("Voice recognition not supported in your browser");
            }
        }

        // Toggle voice listening
        function toggleListening() {
            if (!recognition) return;

            if (!isListening) {
                recognition.start();
                isListening = true;
                document.getElementById('micButton').classList.add('listening');
                showNotification("Listening... Speak now");
            } else {
                recognition.stop();
                isListening = false;
                document.getElementById('micButton').classList.remove('listening');
            }
        }

        // Handle Enter key press
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Main message sending function
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;

            // Add user message to chat
            addMessageToChat(message, 'user');
            input.value = '';

            // Update user stats
            userProfile.messagesSent++;
            document.getElementById('messageCount').textContent = userProfile.messagesSent;
            saveUserData();

            // Show typing indicator
            showTypingIndicator();

            // Generate and show bot response
            setTimeout(() => {
                hideTypingIndicator();
                const response = generateResponse(message);
                addMessageToChat(response, 'bot');
                speakResponse(response);
            }, 1000 + Math.random() * 1000);
        }

        // Add message to chat box
        function addMessageToChat(message, sender) {
            const chatBox = document.getElementById('chatBox');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            const avatar = document.createElement('div');
            avatar.className = `message-avatar ${sender}-msg-avatar`;
            avatar.textContent = sender === 'user' ? 'U' : 'J';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.innerHTML = message;
            
            const time = document.createElement('div');
            time.className = 'message-time';
            time.textContent = new Date().toLocaleTimeString('hi-IN', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            content.appendChild(time);
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            chatBox.appendChild(messageDiv);
            
            // Scroll to bottom
            chatBox.scrollTop = chatBox.scrollHeight;
            
            // Add to history
            chatHistory.push({ sender, message, time: new Date() });
            if (chatHistory.length > CONFIG.ai.contextMemory) {
                chatHistory.shift();
            }
        }

        // Generate intelligent response
        function generateResponse(userMessage) {
            const lowerMessage = userMessage.toLowerCase();
            
            // Check for exact matches first
            for (const [key, response] of Object.entries(KNOWLEDGE_BASE)) {
                if (lowerMessage.includes(key.toLowerCase())) {
                    return typeof response === 'function' ? response() : response;
                }
            }
            
            // Check for partial matches with synonyms
            const response = findBestMatch(lowerMessage);
            if (response) return response;
            
            // Context-aware responses
            const contextResponse = getContextAwareResponse(lowerMessage);
            if (contextResponse) return contextResponse;
            
            // Default creative response
            return getCreativeResponse();
        }

        // Find best match using advanced matching
        function findBestMatch(message) {
            const synonyms = {
                'name': ['‡§®‡§æ‡§Æ', 'name', 'whats your name', 'tumhara naam'],
                'how': ['‡§ï‡•à‡§∏‡•á', 'how', 'kaise', 'kese'],
                'weather': ['‡§Æ‡•å‡§∏‡§Æ', 'weather', 'mosam', 'temperature'],
                'time': ['‡§∏‡§Æ‡§Ø', 'time', 'samay', 'kitna bajaa']
            };
            
            for (const [category, words] of Object.entries(synonyms)) {
                if (words.some(word => message.includes(word))) {
                    switch(category) {
                        case 'name':
                            return "‡§Æ‡•á‡§∞‡§æ ‡§®‡§æ‡§Æ Jigyasa ‡§π‡•à! ‡§Æ‡•à‡§Ç ‡§è‡§ï AI ‡§∏‡§π‡§æ‡§Ø‡§ï ‡§π‡•Ç‡§Å‡•§";
                        case 'how':
                            return "‡§Æ‡•à‡§Ç ‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§π‡•Ç‡§Å, ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶! ‡§Ü‡§™ ‡§ï‡•à‡§∏‡•á ‡§π‡•à‡§Ç?";
                        case 'weather':
                            return "‡§Æ‡•à‡§Ç real-time ‡§Æ‡•å‡§∏‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§§‡§æ ‡§∏‡§ï‡§§‡•Ä, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ü‡§™ weather app check ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç";
                        case 'time':
                            return `‡§Ö‡§≠‡•Ä ‡§∏‡§Æ‡§Ø ‡§π‡•à: ${new Date().toLocaleTimeString('hi-IN')}`;
                    }
                }
            }
            
            return null;
        }

        // Get context-aware response
        function getContextAwareResponse(message) {
            const lastMessage = chatHistory[chatHistory.length - 2];
            
            if (lastMessage && lastMessage.sender === 'user') {
                if (lastMessage.message.toLowerCase().includes('name') && message.includes('what')) {
                    return "‡§Æ‡•à‡§Ç Jigyasa ‡§π‡•Ç‡§Å! ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§Æ‡•á‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§≠‡•Ç‡§≤ ‡§ó‡§è? üòä";
                }
                
                if (lastMessage.message.toLowerCase().includes('how') && message.includes('fine')) {
                    return "‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ö‡•ç‡§õ‡§æ! ‡§Ü‡§™‡§ï‡•á ‡§¶‡§ø‡§® ‡§Ö‡§ö‡•ç‡§õ‡•á ‡§ó‡•Å‡§ú‡§∞‡•á‡§Ç!";
                }
            }
            
            return null;
        }

        // Get creative default response
        function getCreativeResponse() {
            const responses = [
                "‡§Ø‡§π ‡§è‡§ï ‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§∏‡§µ‡§æ‡§≤ ‡§π‡•à! ‡§Æ‡•à‡§Ç ‡§Ö‡§≠‡•Ä ‡§á‡§∏‡§ï‡§æ ‡§ú‡§µ‡§æ‡§¨ ‡§®‡§π‡•Ä‡§Ç ‡§ú‡§æ‡§®‡§§‡•Ä, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Æ‡•à‡§Ç ‡§∏‡•Ä‡§ñ ‡§∞‡§π‡•Ä ‡§π‡•Ç‡§Å‡•§",
                "‡§Æ‡§æ‡§´ ‡§ï‡•Ä‡§ú‡§ø‡§è, ‡§Æ‡•à‡§Ç ‡§á‡§∏ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ï‡§æ ‡§â‡§§‡•ç‡§§‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§ú‡§æ‡§®‡§§‡•Ä‡•§ ‡§Ü‡§™ ‡§ï‡•Å‡§õ ‡§î‡§∞ ‡§™‡•Ç‡§õ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç?",
                "‡§µ‡§æ‡§π! ‡§Ø‡§π ‡§∏‡§µ‡§æ‡§≤ ‡§§‡•ã ‡§Æ‡•Å‡§∂‡•ç‡§ï‡§ø‡§≤ ‡§π‡•à‡•§ ‡§Æ‡•à‡§Ç ‡§Ö‡§≠‡•Ä ‡§á‡§∏‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§ú‡§æ‡§®‡§§‡•Ä, ‡§≤‡•á‡§ï‡§ø‡§® ‡§ú‡§≤‡•ç‡§¶ ‡§π‡•Ä ‡§∏‡•Ä‡§ñ‡•Ç‡§Ç‡§ó‡•Ä!",
                "‡§Æ‡•à‡§Ç ‡§Ö‡§≠‡•Ä ‡§á‡§∏ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ï‡§æ ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡•á‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Ç‡§Å‡•§ ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§ï‡•Å‡§õ ‡§î‡§∞ ‡§™‡•Ç‡§õ‡§®‡§æ ‡§ö‡§æ‡§π‡•á‡§Ç‡§ó‡•á?"
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        // Show typing indicator
        function showTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'block';
            document.getElementById('chatBox').scrollTop = document.getElementById('chatBox').scrollHeight;
        }

        // Hide typing indicator
        function hideTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'none';
        }

        // Speak response
        function speakResponse(text) {
            if (!CONFIG.voice.enabled || !userProfile.preferences.voiceEnabled) return;
            
            // Clean text for speech
            const cleanText = text.replace(/[<>&]/g, '');
            
            const speech = new SpeechSynthesisUtterance(cleanText);
            speech.lang = userProfile.preferences.language === 'hi' ? 'hi-IN' : 'en-US';
            speech.rate = parseFloat(document.getElementById('voiceSpeed').value);
            
            const voices = speechSynthesis.getVoices();
            const preferredVoice = voices.find(voice => 
                voice.lang === speech.lang && 
                voice.name.toLowerCase().includes(document.getElementById('voiceType').value)
            );
            
            if (preferredVoice) {
                speech.voice = preferredVoice;
            }
            
            speechSynthesis.speak(speech);
        }

        // Quick actions
        function quickAction(action) {
            let response = "";
            
            switch(action) {
                case 'weather':
                    response = "‡§Æ‡•à‡§Ç real-time ‡§Æ‡•å‡§∏‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§§‡§æ ‡§∏‡§ï‡§§‡•Ä, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ü‡§™ weather app check ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ü‡§ú ‡§ï‡§æ ‡§Æ‡•å‡§∏‡§Æ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§∞‡§π‡§®‡•á ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à‡•§";
                    break;
                case 'joke':
                    response = getRandomJoke();
                    break;
                case 'fact':
                    response = getRandomFact();
                    break;
                case 'quote':
                    response = getRandomQuote();
                    break;
                case 'news':
                    response = "‡§Ü‡§ú ‡§ï‡•Ä ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ñ‡§¨‡§∞‡•á‡§Ç: Technology ‡§ï‡•á ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§®‡§è innovation, Education system ‡§Æ‡•á‡§Ç ‡§∏‡•Å‡§ß‡§æ‡§∞, ‡§î‡§∞ ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞‡•§";
                    break;
                case 'story':
                    response = getRandomStory();
                    break;
                case 'calculator':
                    showCalculator();
                    return;
                case 'converter':
                    showConverter();
                    return;
            }
            
            addMessageToChat(response, 'bot');
            speakResponse(response);
        }

        // Quick replies
        function quickReply(type) {
            const messages = {
                'hello': '‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§ï‡•à‡§∏‡•á ‡§π‡•ã ‡§Ü‡§™?',
                'how_are_you': '‡§Æ‡•à‡§Ç ‡§¨‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§†‡•Ä‡§ï ‡§π‡•Ç‡§Å! ‡§Ü‡§™ ‡§∏‡•Å‡§®‡§æ‡§á‡§è?',
                'time': `‡§Ö‡§≠‡•Ä ‡§∏‡§Æ‡§Ø ‡§π‡•à: ${new Date().toLocaleTimeString('hi-IN')}`,
                'joke': getRandomJoke(),
                'weather': '‡§Ü‡§ú ‡§ï‡§æ ‡§Æ‡•å‡§∏‡§Æ ‡§∏‡•Å‡§π‡§æ‡§µ‡§®‡§æ ‡§π‡•à! ‡§¨‡§æ‡§π‡§∞ ‡§ò‡•Ç‡§Æ‡§®‡•á ‡§ï‡§æ ‡§Æ‡§® ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à‡•§'
            };
            
            document.getElementById('messageInput').value = messages[type];
            sendMessage();
        }

        // Utility functions
        function getRandomJoke() {
            const jokes = ADVANCED_RESPONSES.jokes;
            return jokes[Math.floor(Math.random() * jokes.length)];
        }

        function getRandomFact() {
            const facts = ADVANCED_RESPONSES.facts;
            return facts[Math.floor(Math.random() * facts.length)];
        }

        function getRandomStory() {
            const stories = ADVANCED_RESPONSES.stories;
            return stories[Math.floor(Math.random() * stories.length)];
        }

        function getRandomQuote() {
            const quotes = ADVANCED_RESPONSES.quotes;
            return quotes[Math.floor(Math.random() * quotes.length)];
        }

        // Theme and UI functions
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const button = event.target;
            button.textContent = document.body.classList.contains('dark-mode') ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
            userProfile.preferences.theme = document.body.classList.contains('dark-mode') ? 'dark' : 'light';
            saveUserData();
        }

        function changeBackground() {
            const gradients = [
                'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
                'linear-gradient(135deg, #fa709a 0%, #fee140 100%)'
            ];
            
            const randomGradient = gradients[Math.floor(Math.random() * gradients.length)];
            document.body.style.background = randomGradient;
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Games and tools
        function showGames() {
            const gamesContainer = document.getElementById('gamesContainer');
            gamesContainer.style.display = gamesContainer.style.display === 'block' ? 'none' : 'block';
        }

        function startGame(gameType) {
            let gameMessage = "";
            
            switch(gameType) {
                case 'quiz':
                    const quiz = GAMES.quiz[Math.floor(Math.random() * GAMES.quiz.length)];
                    gameMessage = `üß† ‡§ï‡•ç‡§µ‡§ø‡§ú: ${quiz.question}\n\n‡§µ‡§ø‡§ï‡§≤‡•ç‡§™:\n${quiz.options.map((opt, i) => `${i+1}. ${opt}`).join('\n')}`;
                    break;
                case 'riddle':
                    const riddle = GAMES.riddles[Math.floor(Math.random() * GAMES.riddles.length)];
                    gameMessage = `ü§î ‡§™‡§π‡•á‡§≤‡•Ä: ${riddle.riddle}\n\n(‡§ú‡§µ‡§æ‡§¨ ‡§ï‡•á ‡§≤‡§ø‡§è '‡§â‡§§‡•ç‡§§‡§∞' ‡§≤‡§ø‡§ñ‡•á‡§Ç)`;
                    break;
                case 'math':
                    const num1 = Math.floor(Math.random() * 50) + 1;
                    const num2 = Math.floor(Math.random() * 50) + 1;
                    const operators = ['+', '-', '*'];
                    const operator = operators[Math.floor(Math.random() * operators.length)];
                    gameMessage = `‚ûó ‡§ó‡§£‡§ø‡§§: ${num1} ${operator} ${num2} = ?`;
                    break;
                case 'word':
                    const words = ['‡§∏‡•ç‡§ï‡•Ç‡§≤', '‡§ï‡§ø‡§§‡§æ‡§¨', '‡§¶‡•ã‡§∏‡•ç‡§§', '‡§™‡§∞‡§ø‡§µ‡§æ‡§∞', '‡§ñ‡•á‡§≤'];
                    const randomWord = words[Math.floor(Math.random() * words.length)];
                    gameMessage = `üî§ ‡§∂‡§¨‡•ç‡§¶ ‡§ñ‡•á‡§≤: '${randomWord}' ‡§ï‡§æ ‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡§µ‡§æ‡§ö‡•Ä ‡§∂‡§¨‡•ç‡§¶ ‡§¨‡§§‡§æ‡§á‡§è`;
                    break;
            }
            
            addMessageToChat(gameMessage, 'bot');
            showGames(); // Hide games container
        }

        function showCalculator() {
            const expression = prompt("‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü‡§∞:\n‡§ó‡§£‡§ø‡§§ ‡§ï‡§æ expression ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç (‡§ú‡•à‡§∏‡•á: 2+2, 10*5):");
            if (expression) {
                try {
                    const result = eval(expression);
                    addMessageToChat(`üßÆ ‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§∂‡§®: ${expression} = ${result}`, 'bot');
                } catch (error) {
                    addMessageToChat("‚ùå ‡§ó‡§≤‡§§ expression! ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§π‡•Ä format ‡§Æ‡•á‡§Ç ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§", 'bot');
                }
            }
        }

        function showConverter() {
            const conversion = prompt("‡§Ø‡•Ç‡§®‡§ø‡§ü ‡§ï‡§®‡§µ‡§∞‡•ç‡§ü‡§∞:\n‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç (‡§ú‡•à‡§∏‡•á: '10 km to m', '100 celsius to fahrenheit'):");
            if (conversion) {
                const response = handleUnitConversion(conversion);
                addMessageToChat(response, 'bot');
            }
        }

        function handleUnitConversion(input) {
            // Simple unit conversion logic
            const lowerInput = input.toLowerCase();
            
            if (lowerInput.includes('km') && lowerInput.includes('m')) {
                const km = parseFloat(input);
                if (!isNaN(km)) {
                    return `üìê ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞‡§£: ${km} km = ${km * 1000} meters`;
                }
            }
            
            if (lowerInput.includes('celsius') && lowerInput.includes('fahrenheit')) {
                const celsius = parseFloat(input);
                if (!isNaN(celsius)) {
                    const fahrenheit = (celsius * 9/5) + 32;
                    return `üå°Ô∏è ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞‡§£: ${celsius}¬∞C = ${fahrenheit.toFixed(2)}¬∞F`;
                }
            }
            
            return "‚ùå ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞‡§£ ‡§∏‡§Æ‡§ù ‡§®‡§π‡•Ä‡§Ç ‡§Ü‡§Ø‡§æ‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§á‡§∏ format ‡§Æ‡•á‡§Ç try ‡§ï‡§∞‡•á‡§Ç: '10 km to m'";
        }

        // Voice speed control
        document.getElementById('voiceSpeed').addEventListener('input', function() {
            document.getElementById('speedValue').textContent = this.value;
        });

        // Personality change
        document.getElementById('personality').addEventListener('change', function() {
            showNotification(`Personality changed to: ${this.options[this.selectedIndex].text}`);
        });

        // Initialize when page loads
        window.onload = init;
    </script>
</body>
</html>
